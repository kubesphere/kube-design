---
sidebar_position: 7
---

# useLocalStorage

ç®¡ç† localStorage çš„ Hookï¼Œæä¾›ç±»å‹å®‰å…¨çš„æœ¬åœ°å­˜å‚¨æ“ä½œï¼Œå¹¶æ”¯æŒè·¨æ ‡ç­¾é¡µåŒæ­¥ã€‚

## åŸºæœ¬ç”¨æ³•

```jsx live
function Demo() {
  const [value, setValue] = useLocalStorage({ key: 'demo-value', defaultValue: '' });

  return (
    <div>
      <Input
        placeholder="è¾“å…¥å†…å®¹ï¼ˆä¼šè‡ªåŠ¨ä¿å­˜ï¼‰"
        value={value}
        onChange={(e) => setValue(e.target.value)}
      />
      <div style={{ marginTop: '12px', fontSize: '14px', color: 'var(--ifm-color-emphasis-700)' }}>
        å½“å‰å­˜å‚¨çš„å€¼: {value || '(ç©º)'}
      </div>
      <Button
        onClick={() => setValue('')}
        size="small"
        style={{ marginTop: '12px' }}
      >
        æ¸…ç©º
      </Button>
    </div>
  );
}
```

## ä¸»é¢˜æŒä¹…åŒ–

ä¿å­˜ç”¨æˆ·çš„ä¸»é¢˜é€‰æ‹©ï¼š

```jsx live
function Demo() {
  const [theme, setTheme] = useLocalStorage({ 
    key: 'app-theme', 
    defaultValue: 'light' 
  });

  return (
    <div>
      <Group spacing="md">
        <Button 
          onClick={() => setTheme('light')}
          variant={theme === 'light' ? 'filled' : 'outline'}
        >
          â˜€ï¸ äº®è‰²
        </Button>
        <Button 
          onClick={() => setTheme('dark')}
          variant={theme === 'dark' ? 'filled' : 'outline'}
        >
          ğŸŒ™ æš—è‰²
        </Button>
        <Button 
          onClick={() => setTheme('auto')}
          variant={theme === 'auto' ? 'filled' : 'outline'}
        >
          ğŸ”„ è‡ªåŠ¨
        </Button>
      </Group>
      <div
        style={{
          marginTop: '20px',
          padding: '24px',
          backgroundColor: 
            theme === 'dark' ? '#1a1a1a' : 
            theme === 'light' ? '#ffffff' : 
            'var(--ifm-background-surface-color)',
          color: 
            theme === 'dark' ? '#ffffff' : 
            theme === 'light' ? '#000000' : 
            'var(--ifm-font-color-base)',
          border: '1px solid var(--ifm-color-emphasis-300)',
          borderRadius: '8px',
          transition: 'all 0.3s',
        }}
      >
        <h4>å½“å‰ä¸»é¢˜: {theme}</h4>
        <p>åˆ·æ–°é¡µé¢åä¸»é¢˜ä¼šä¿æŒä¸å˜</p>
      </div>
    </div>
  );
}
```

## ç”¨æˆ·åå¥½è®¾ç½®

ä¿å­˜å¤æ‚çš„ç”¨æˆ·é…ç½®ï¼š

```jsx live
function Demo() {
  const [fontSize, setFontSize] = useLocalStorage({ 
    key: 'font-size', 
    defaultValue: '16' 
  });
  const [notifications, setNotifications] = useLocalStorage({ 
    key: 'notifications', 
    defaultValue: 'true' 
  });

  return (
    <div>
      <div style={{ marginBottom: '20px' }}>
        <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>
          å­—ä½“å¤§å°
        </label>
        <Group spacing="sm">
          {['14', '16', '18', '20'].map((size) => (
            <Button
              key={size}
              size="small"
              variant={fontSize === size ? 'filled' : 'outline'}
              onClick={() => setFontSize(size)}
            >
              {size}px
            </Button>
          ))}
        </Group>
      </div>
      
      <div style={{ marginBottom: '20px' }}>
        <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
          <input
            type="checkbox"
            checked={notifications === 'true'}
            onChange={(e) => setNotifications(e.target.checked ? 'true' : 'false')}
            style={{ marginRight: '8px' }}
          />
          <span>å¯ç”¨é€šçŸ¥</span>
        </label>
      </div>

      <div
        style={{
          padding: '20px',
          backgroundColor: 'var(--ifm-color-emphasis-100)',
          borderRadius: '8px',
          fontSize: `${fontSize}px`,
        }}
      >
        <h4 style={{ margin: '0 0 12px 0' }}>é¢„è§ˆåŒºåŸŸ</h4>
        <p style={{ margin: 0 }}>
          å­—ä½“å¤§å°: {fontSize}px {notifications === 'true' && 'Â· é€šçŸ¥å·²å¯ç”¨ ğŸ””'}
        </p>
      </div>
    </div>
  );
}
```

## è¡¨å•è‰ç¨¿è‡ªåŠ¨ä¿å­˜

è‡ªåŠ¨ä¿å­˜è¡¨å•è¾“å…¥ï¼š

```jsx live
function Demo() {
  const [title, setTitle] = useLocalStorage({ key: 'draft-title', defaultValue: '' });
  const [content, setContent] = useLocalStorage({ key: 'draft-content', defaultValue: '' });

  const handleClear = () => {
    setTitle('');
    setContent('');
  };

  return (
    <div>
      <div style={{ marginBottom: '12px' }}>
        <Input
          placeholder="æ ‡é¢˜"
          value={title}
          onChange={(e) => setTitle(e.target.value)}
        />
      </div>
      <div style={{ marginBottom: '12px' }}>
        <Textarea
          placeholder="å†…å®¹ï¼ˆè‡ªåŠ¨ä¿å­˜è‰ç¨¿ï¼‰"
          value={content}
          onChange={(e) => setContent(e.target.value)}
          rows={4}
        />
      </div>
      <Group spacing="md">
        <Button onClick={handleClear} variant="outline">
          æ¸…ç©ºè‰ç¨¿
        </Button>
      </Group>
      {(title || content) && (
        <div
          style={{
            marginTop: '16px',
            padding: '12px',
            backgroundColor: 'var(--ifm-color-success-lightest)',
            borderRadius: '6px',
            fontSize: '14px',
          }}
        >
          âœ“ è‰ç¨¿å·²è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°
        </div>
      )}
    </div>
  );
}
```

## å‡½æ•°å¼æ›´æ–°

æ”¯æŒåŸºäºå½“å‰å€¼çš„æ›´æ–°ï¼š

```jsx live
function Demo() {
  const [count, setCount] = useLocalStorage({ key: 'counter', defaultValue: '0' });

  const increment = () => setCount((prev) => String(Number(prev) + 1));
  const decrement = () => setCount((prev) => String(Number(prev) - 1));
  const reset = () => setCount('0');

  return (
    <div style={{ textAlign: 'center' }}>
      <div
        style={{
          fontSize: '48px',
          fontWeight: 'bold',
          marginBottom: '20px',
          color: 'var(--ifm-color-primary)',
        }}
      >
        {count}
      </div>
      <Group spacing="md">
        <Button onClick={decrement}>-</Button>
        <Button onClick={increment}>+</Button>
        <Button onClick={reset} variant="outline">é‡ç½®</Button>
      </Group>
      <p style={{ marginTop: '16px', fontSize: '14px', color: 'var(--ifm-color-emphasis-700)' }}>
        è®¡æ•°ä¼šä¿å­˜åˆ° localStorage
      </p>
    </div>
  );
}
```

## API

### å‚æ•°

```ts
function useLocalStorage<T extends string>({
  key,
  defaultValue,
}: {
  key: string;
  defaultValue?: T;
}): [T, (val: T | ((prevState: T) => T)) => void]
```

| å‚æ•° | è¯´æ˜ | ç±»å‹ | é»˜è®¤å€¼ |
|------|------|------|--------|
| key | localStorage çš„é”®å | `string` | - |
| defaultValue | é»˜è®¤å€¼ | `T` | `undefined` |

### è¿”å›å€¼

è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ³•ç±»ä¼¼ `useState`ï¼š

| ç´¢å¼• | è¯´æ˜ | ç±»å‹ |
|------|------|------|
| [0] | å½“å‰å€¼ | `T` |
| [1] | æ›´æ–°å‡½æ•° | `(val: T \| ((prevState: T) => T)) => void` |

## ç‰¹æ€§

- **ç±»å‹å®‰å…¨**: æä¾› TypeScript ç±»å‹æ”¯æŒ
- **è·¨æ ‡ç­¾é¡µåŒæ­¥**: è‡ªåŠ¨åŒæ­¥å¤šä¸ªæ ‡ç­¾é¡µçš„å€¼
- **SSR å‹å¥½**: å®‰å…¨å¤„ç†æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯
- **é»˜è®¤å€¼**: æ”¯æŒè®¾ç½®é»˜è®¤å€¼
- **å‡½æ•°å¼æ›´æ–°**: æ”¯æŒåŸºäºå½“å‰å€¼çš„æ›´æ–°

## ä½¿ç”¨åœºæ™¯

- **ç”¨æˆ·åå¥½**: ä¿å­˜ä¸»é¢˜ã€è¯­è¨€ç­‰ç”¨æˆ·è®¾ç½®
- **è¡¨å•è‰ç¨¿**: è‡ªåŠ¨ä¿å­˜è¡¨å•è¾“å…¥
- **è´­ç‰©è½¦**: æŒä¹…åŒ–è´­ç‰©è½¦æ•°æ®
- **æµè§ˆå†å²**: è®°å½•ç”¨æˆ·æµè§ˆå†å²
- **ä¸´æ—¶æ•°æ®**: å­˜å‚¨ä¸éœ€è¦åŒæ­¥åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ•°æ®
